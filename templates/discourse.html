<html>
<head>
<title>Discourse Annotator</title>
<script src="/static/jq/jquery-1.4.2.min.js"></script>
<script src="/static/jq/jquery.ui.core.min.js"></script>
<script src="/static/jq/jquery.ui.widget.min.js"></script>
<script src="/static/jq/jquery.ui.mouse.min.js"></script>
<script src="/static/jq/jquery.ui.button.min.js"></script>
<script src="/static/jq/jquery.ui.draggable.min.js"></script>
<script src="/static/jq/jquery.ui.position.min.js"></script>
<script src="/static/jq/jquery.ui.resizable.min.js"></script>
<script src="/static/jq/jquery.ui.dialog.min.js"></script>
<script src="/static/jq/jquery.layout.min-1.2.0.js"></script>
<script src="/static/cm/codemirror.js"></script>
<script src="/static/json2.js"></script>
<script src="/static/qct_jquery.js"></script>
<link rel="stylesheet" href="/static/themes/base/jquery.ui.all.css" type="text/css">
<link rel="stylesheet" href="/static/themes/redmond/jquery-ui-1.8.2.custom.css" type="text/css">
<link rel="stylesheet" href="/static/pycwb.css" type="text/css">
<script src="/static/discourse.js"></script>
<script type="text/javascript">
  disc_id={{disc_id}};
  sent_id={{sent_id}};
  tokens={{tokens}};
  sentences={{sentences}};
  edus={{edus}};
  indent={{indent}};
  topics={{topics}};
  relations={{relations}};

save_endpoint='/pycwb/saveDiscourse/'+disc_id;

function on_layout_resize(elm,pane) {
 $('#text').css({'height':($('.ui-layout-center').height()-2)+'px'});
}

$(function() {
 $info=$('#dialog').dialog({title:'Info',autoOpen:false,
   modal:true,close:refocus_text});
$('#relations-text').text(relations)
   .blur(function() { 
  relations=$('#relations-text').val(); 
  var errors=parse_relations(relations);
  if (errors!='') {
    alert(errors);
  }
  redisplay_all();
  dirty['relations']=relations; 
  resetTimeout();
  return 1;
});

$rels=$('#relations-div').dialog({title:'Relations',autoOpen:false,
   close:refocus_text,resize:function(event,ui){
   editor.width($('#relations-div').width()-15) 
   .height($('#relations-div').height()-10);
 }});
$('body').layout({applyDefaultStyles: true,
 onresize:on_layout_resize,onopen:on_layout_resize,onclose:on_layout_resize});
on_layout_resize();
$('#status').text("loaded.");
});
</script>
<link rel="stylesheet" href="/static/discourseEdit.css">
</head>
<body onload="fill_segments();" bgcolor="#eeeeee">
<div class="ui-layout-center">
<div id="text" style="position:relative; height: 400px; margin:1px; border: 2px solid #aaaaaa; overflow:auto">
</div>
<div id="status">
</div>
</div>
<div id="auxinput" style="height:0px">
</div>
<div id="dialog" style="display:none">
</div>
<div class="ui-layout-south">
<div id="relations-div" style="width:280px;height:100px">
<textarea style="width:270px;height:90px" id="relations-text">
</textarea>
</div>
</div>
</body>
